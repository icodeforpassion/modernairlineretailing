<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-VHHFDP9B88"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-VHHFDP9B88');
  </script>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Exam 30-Second Interval Timer</title>
<style>
    body {
        font-family: 'Arial', sans-serif;
        background: #f0f4f8;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 100vh;
        margin: 0;
        padding: 10px;
    }
    h1#countdown {
        font-size: 10vw; /* scales with screen width */
        margin: 20px 0;
        transition: color 0.5s;
        text-align: center;
    }
    .controls {
        display: flex;
        gap: 10px;
        margin-bottom: 30px;
        flex-wrap: wrap;
        justify-content: center;
    }
    input[type="number"] {
        padding: 15px;
        font-size: 1.2rem;
        width: 150px;
        text-align: center;
        border-radius: 8px;
        border: 1px solid #ccc;
        -webkit-appearance: none;
    }
    input[type="number"]:focus {
        outline: none;
        border-color: #28a745;
    }
    button {
        padding: 15px 25px;
        font-size: 1.2rem;
        cursor: pointer;
        border: none;
        border-radius: 10px;
        transition: background 0.3s, color 0.3s;
        touch-action: manipulation; /* better for touch */
    }
    button:hover { opacity: 0.9; }
    .start-btn { background: #28a745; color: white; }
    .reset-btn { background: #dc3545; color: white; }

    .status {
        font-size: 5vw;
        margin-top: 20px;
        font-weight: bold;
        text-align: center;
    }
    .status div {
        margin: 10px 0;
    }
</style>
  <link rel="stylesheet" href="/assets/site.css"/>
</head>
<body>
  <header class="site-header"></header>
  <main class="page-content">

<div class="controls">
    <input type="number" id="totalMinutes" placeholder="Total minutes" value="180" min="1">
    <button class="start-btn" onclick="startTimer()">Start</button>
    <button class="reset-btn" onclick="resetTimer()">Reset</button>
</div>

<h1 id="countdown">0</h1>

<div class="status">
    <div>Total Elapsed: <span id="elapsed">0</span> min</div>
    <div>Remaining: <span id="remaining">0</span> min</div>
</div>

<script>
let interval;
let secondsCounter = 0;
let totalElapsed = 0;
let totalMinutes = 180;
let running = false;

// DOM elements
const countdownEl = document.getElementById('countdown');
const elapsedEl = document.getElementById('elapsed');
const remainingEl = document.getElementById('remaining');
const totalMinutesInput = document.getElementById('totalMinutes');

function updateDisplay() {
    countdownEl.textContent = secondsCounter + 1;

    if(secondsCounter < 10){
        countdownEl.style.color = '#28a745'; // Green
    } else if(secondsCounter < 25){
        countdownEl.style.color = '#ffc107'; // Amber
    } else {
        countdownEl.style.color = '#dc3545'; // Red
    }

    elapsedEl.textContent = totalElapsed.toFixed(1);
    remainingEl.textContent = (totalMinutes - totalElapsed).toFixed(1);
}

// Save state to localStorage
function saveState() {
    localStorage.setItem('timerData', JSON.stringify({
        startTime: Date.now(),
        totalElapsed,
        totalMinutes
    }));
}

// Load state from localStorage
function loadState() {
    const data = JSON.parse(localStorage.getItem('timerData'));
    if(data){
        totalElapsed = data.totalElapsed;
        totalMinutes = data.totalMinutes;
        // Calculate seconds passed since last save
        const elapsedSince = (Date.now() - data.startTime) / 1000; // in seconds
        const fullIntervals = Math.floor(elapsedSince / 30);
        totalElapsed += 0.5 * fullIntervals;
        secondsCounter = Math.floor(elapsedSince % 30);
        if(totalElapsed >= totalMinutes){
            totalElapsed = totalMinutes;
            secondsCounter = 0;
            running = false;
        }
        updateDisplay();
        return true;
    }
    return false;
}

function startTimer() {
    if(running) return;
    totalMinutes = parseInt(totalMinutesInput.value) || 180;
    running = true;

    // Save initial state
    saveState();

    interval = setInterval(() => {
        secondsCounter++;
        if(secondsCounter > 30){
            secondsCounter = 1;
            totalElapsed += 0.5; // 30 seconds = 0.5 min
            saveState();
        }
        if(totalElapsed >= totalMinutes){
            clearInterval(interval);
            countdownEl.textContent = "Done!";
            countdownEl.style.color = '#000';
            running = false;
            return;
        }
        updateDisplay();
    }, 1000);
}

function resetTimer() {
    if(confirm("Warning: Resetting will erase this session and there is no way to come back. Do you want to proceed?")) {
        clearInterval(interval);
        secondsCounter = 0;
        totalElapsed = 0;
        running = false;
        localStorage.removeItem('timerData');
        updateDisplay();
    }
}

// Load previous state if page refreshed
loadState();
updateDisplay();
</script>

  </main>
  <footer class="site-footer"></footer>
  <script src="/assets/site.js" defer></script>
  <!-- Analytics configuration notes: Ensure GA4 Enhanced Measurement (including "Outbound clicks") remains enabled, validate tag deployment via https://tagassistant.google.com, monitor linkedin_redirect under GA4 → Reports → Engagement → Events, and mark it as a conversion in GA4 Admin → Events if desired. -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const linkedInLinks = document.querySelectorAll('a[href*="linkedin.com"]');
      linkedInLinks.forEach(function (link) {
        link.addEventListener('click', function (event) {
          if (event.defaultPrevented || event.button !== 0 || event.metaKey || event.ctrlKey || event.shiftKey || event.altKey) {
            return;
          }
          const href = link.href;
          event.preventDefault();
          if (typeof gtag === 'function') {
            gtag('event', 'linkedin_redirect', {
              event_category: 'Outbound',
              event_label: href,
              transport_type: 'beacon'
            });
          }
          setTimeout(function () {
            const target = link.getAttribute('target');
            if (target && target !== '_self') {
              window.open(href, target);
            } else {
              window.location.href = href;
            }
          }, 150);
        });
      });
    });
  </script>
</body>
</html>
