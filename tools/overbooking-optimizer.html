<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Overbooking & Booking Limit Optimizer | Revenue Protection Tool</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="description" content="Calculate optimal overbooking level by balancing spoilage and denied boarding cost using show rate and forecast variability.">
    <style>
        :root{--clr-bg:#0d1b2a;--clr-bg-alt:#132235;--clr-accent:#3298dc;--clr-accent-alt:#4fb1f5;--clr-text:#e8f0f7;--clr-text-dim:#9fb3c5;--radius:14px;}
        body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,sans-serif;background:linear-gradient(to bottom,var(--clr-bg),var(--clr-bg-alt));color:var(--clr-text);}
        main{max-width:1200px;margin:0 auto;padding:6rem 1.2rem 4rem;}
        h1{font-size:clamp(2.1rem,5vw,3rem);margin:0 0 .7rem;font-weight:700;background:linear-gradient(90deg,#fff,#c6d9e8 45%,#82bfe7);-webkit-background-clip:text;color:transparent;}
        .lede{max-width:860px;font-size:1.02rem;color:var(--clr-text-dim);line-height:1.5;margin:0 0 2rem;}
        .grid{display:grid;grid-template-columns:400px 1fr;gap:2.2rem;}
        @media(max-width:1050px){.grid{grid-template-columns:1fr;}}
        .card{background:linear-gradient(165deg,rgba(255,255,255,.05),rgba(255,255,255,.015));border:1px solid rgba(255,255,255,.08);backdrop-filter:blur(12px);border-radius:var(--radius);padding:1.6rem 1.5rem 2rem;}
        label{display:flex;justify-content:space-between;font-size:.65rem;font-weight:600;letter-spacing:.5px;text-transform:uppercase;color:var(--clr-text-dim);margin-bottom:.35rem;}
        input[type=number]{width:100%;background:rgba(255,255,255,.07);border:1px solid rgba(255,255,255,.18);border-radius:10px;padding:.55rem .65rem;color:var(--clr-text);font-size:.85rem;}
        input[type=number]:focus{outline:none;border-color:var(--clr-accent-alt);background:rgba(255,255,255,.12);}
        .field{margin-bottom:1rem;}
        .status{font-size:.7rem;letter-spacing:.55px;text-transform:uppercase;font-weight:600;color:var(--clr-text-dim);min-height:1rem;margin-top:.3rem;}
        .tableWrap{overflow:auto;max-height:390px;margin-top:.7rem;}
        table{width:100%;border-collapse:collapse;font-size:.7rem;}
        th,td{padding:.45rem .5rem;text-align:right;border-bottom:1px solid rgba(255,255,255,.08);}
        th{text-transform:uppercase;font-size:.55rem;letter-spacing:.5px;color:var(--clr-text-dim);}
        tbody tr:hover{background:rgba(255,255,255,.05);}
        .metric-box{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem;margin-top:.8rem;}
        .metric{background:linear-gradient(160deg,rgba(255,255,255,.06),rgba(255,255,255,.02));border:1px solid rgba(255,255,255,.09);padding:.75rem .8rem .85rem;border-radius:12px;}
        .metric h3{margin:0 0 .3rem;font-size:.6rem;letter-spacing:.55px;text-transform:uppercase;color:var(--clr-text-dim);}
        .metric .val{font-size:.95rem;font-weight:600;}
        .share-btn{background:linear-gradient(135deg,var(--clr-accent),var(--clr-accent-alt));border:none;border-radius:999px;padding:.5rem .9rem;font-size:.65rem;letter-spacing:.5px;font-weight:600;color:#fff;cursor:pointer;margin-top:.4rem;}
        .share-btn.copied{background:linear-gradient(135deg,#3bb273,#66d69b);}
        small.note{display:block;font-size:.63rem;color:var(--clr-text-dim);margin-top:.6rem;line-height:1.3;}
        .home-link {
            display:inline-block;
            margin:2rem 0 0 1.2rem;
            font-size:1rem;
            color:var(--clr-accent);
            background:rgba(255,255,255,.05);
            padding:.4rem 1.1rem;
            border-radius:8px;
            text-decoration:none;
            font-weight:600;
            letter-spacing:.3px;
            transition:background .18s;
        }
        .home-link:hover {
            background:rgba(50,152,220,.12);
        }
    </style>
  <link rel="stylesheet" href="/assets/site.css"/>
</head>
<body>
  <header class="site-header"></header>
  <div class="page-content">
<a href="/" class="home-link">⟵ Home</a>
<main>
    <h1>Overbooking & Booking Limit Optimizer</h1>
    <p class="lede">Balance spoilage (empty seats due to no-shows) and denied boarding (IDB) costs. Provide capacity, average fare, show rate and variability; we enumerate booking limits and compute expected contribution to find the optimum.</p>
    <div class="grid">
        <div class="card">
            <div class="field">
                <label for="capacity">Capacity (Seats)</label>
                <input id="capacity" type="number" value="180" min="1">
            </div>
            <div class="field">
                <label for="avgFare">Avg Net Fare (USD)</label>
                <input id="avgFare" type="number" value="220" min="0">
            </div>
            <div class="field">
                <label for="showRate">Mean Show Rate (%)</label>
                <input id="showRate" type="number" value="93" min="0" max="100">
            </div>
            <div class="field">
                <label for="showStd">Show Rate Std Dev (pp)</label>
                <input id="showStd" type="number" value="4" min="0" max="50">
            </div>
            <div class="field">
                <label for="idbCost">Denied Boarding Cost / Pax</label>
                <input id="idbCost" type="number" value="600" min="0">
            </div>
            <div class="field">
                <label for="maxOver">Max Overbooking Seats (range)</label>
                <input id="maxOver" type="number" value="15" min="0">
            </div>
            <div class="status" id="status">Ready.</div>
            <button id="shareBtn" type="button" class="share-btn">Share</button>
            <small class="note">Show rate distribution approximated as normal; seats boarded = min(capacity, shows). Denied boarding seats = max(shows - capacity,0). Expected value computed numerically from discretized distribution. For small samples binomial(n=bookingLimit,p=showRate) would be more exact.</small>
        </div>
        <div class="card">
            <div class="metric-box">
                <div class="metric"><h3>Optimal Booking Limit</h3><div class="val" id="optLimit">-</div></div>
                <div class="metric"><h3>Expected Profit (Opt)</h3><div class="val" id="optProfit">-</div></div>
                <div class="metric"><h3>Expected Spoilage (Opt)</h3><div class="val" id="optSpoilage">-</div></div>
                <div class="metric"><h3>Expected IDB Seats (Opt)</h3><div class="val" id="optIDB">-</div></div>
            </div>
            <div class="tableWrap">
                <table id="resultTable">
                    <thead>
                        <tr>
                            <th>Limit</th><th>Exp Pax</th><th>Spoilage</th><th>IDB</th><th>Profit</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>
</main>
<script>
(function(){
    const els=['capacity','avgFare','showRate','showStd','idbCost','maxOver'];
    const ref={};
    els.forEach(id=>ref[id]=document.getElementById(id));
    const statusEl=document.getElementById('status');
    const tbody=document.querySelector('#resultTable tbody');
    const optLimit=document.getElementById('optLimit');
    const optProfit=document.getElementById('optProfit');
    const optSpoilage=document.getElementById('optSpoilage');
    const optIDB=document.getElementById('optIDB');
    const shareBtn=document.getElementById('shareBtn');

    function num(v){return parseFloat(v)||0;}

    function normalPDF(x,mean,std){
        if(std<=0) return x===mean?1:0;
        const a=1/(std*Math.sqrt(2*Math.PI));
        return a*Math.exp(-Math.pow(x-mean,2)/(2*Math.pow(std,2)));
    }

    function normalPMass(mean,std,low,high,step){
        // approximate mass across integer seats
        const vals=[];
        for(let x=low;x<=high;x+=step){
            vals.push({x, p:normalPDF(x,mean,std)});
        }
        const sum=vals.reduce((s,v)=>s+v.p,0);
        vals.forEach(v=>v.p/=sum);
        return vals;
    }

    function calc(){
        const C=num(ref.capacity.value);
        const fare=num(ref.avgFare.value);
        const showRate=num(ref.showRate.value)/100;
        const showStd=num(ref.showStd.value)/100;
        const idbCost=num(ref.idbCost.value);
        const maxOver=num(ref.maxOver.value);

        if(C<=0||fare<=0||showRate<=0){
            statusEl.textContent='Enter valid inputs.';
            return;
        }
        tbody.innerHTML='';
        let best={profit:-Infinity};

        for(let limit=C; limit<=C+maxOver; limit++){
            // Show distribution approx: mean shows = limit * showRate, std = limit * showStd (approx; can use sqrt(n p (1-p)), but we let user specify)
            const meanShows= limit*showRate;
            const stdShows= limit*showStd || Math.sqrt(limit*showRate*(1-showRate));
            const dist = normalPMass(meanShows,stdShows,0,limit+Math.max(20,Math.ceil(4*stdShows)),1);
            let expPax=0, expSpoil=0, expIDB=0;
            dist.forEach(d=>{
                const shows=d.x;
                const boarded=Math.min(C,shows);
                const spoil=Math.max(C - shows,0); // empty seats if shows < capacity
                const idb=Math.max(shows - C,0);
                expPax += boarded * d.p;
                expSpoil += spoil * d.p;
                expIDB += idb * d.p;
            });
            const revenue = expPax * fare;
            const costIDB = expIDB * idbCost;
            const profit = revenue - costIDB;
            if(profit>best.profit){
                best={limit,profit,expPax,expSpoil,expIDB};
            }
            const tr=document.createElement('tr');
            tr.innerHTML=`<td>${limit}</td><td>${expPax.toFixed(1)}</td><td>${expSpoil.toFixed(1)}</td><td>${expIDB.toFixed(2)}</td><td>${profit.toFixed(0)}</td>`;
            if(limit===best.limit) tr.style.background='rgba(79,177,245,.2)';
            tbody.appendChild(tr);
        }
        optLimit.textContent=best.limit;
        optProfit.textContent='$'+best.profit.toFixed(0);
        optSpoilage.textContent=best.expSpoil.toFixed(1);
        optIDB.textContent=best.expIDB.toFixed(2);
        statusEl.textContent='Computed.';
        updateURL();
    }

    function updateURL(){
        const url=new URL(location.href);
        els.forEach(e=>url.searchParams.set(e,ref[e].value));
        history.replaceState({},'',url.toString());
    }
    function loadFromURL(){
        const p=new URLSearchParams(location.search);let ch=false;
        els.forEach(e=>{if(p.has(e)){ref[e].value=p.get(e);ch=true;}});
        if(ch) calc();
    }
    els.forEach(e=>ref[e].addEventListener('input',calc));
    shareBtn.addEventListener('click',()=>{
        navigator.clipboard.writeText(location.href).then(()=>{
            shareBtn.classList.add('copied');shareBtn.textContent='Copied!';
            setTimeout(()=>{shareBtn.classList.remove('copied');shareBtn.textContent='Share';},1400);
        });
    });
    loadFromURL(); calc();
})();
</script>
    </div>
  <footer class="site-footer"></footer>
  <script src="/assets/site.js" defer></script>
  <!-- Analytics configuration notes: Ensure GA4 Enhanced Measurement (including "Outbound clicks") remains enabled, validate tag deployment via https://tagassistant.google.com, monitor linkedin_redirect under GA4 → Reports → Engagement → Events, and mark it as a conversion in GA4 Admin → Events if desired. -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const linkedInLinks = document.querySelectorAll('a[href*="linkedin.com"]');
      linkedInLinks.forEach(function (link) {
        link.addEventListener('click', function (event) {
          if (event.defaultPrevented || event.button !== 0 || event.metaKey || event.ctrlKey || event.shiftKey || event.altKey) {
            return;
          }
          const href = link.href;
          event.preventDefault();
          if (typeof gtag === 'function') {
            gtag('event', 'linkedin_redirect', {
              event_category: 'Outbound',
              event_label: href,
              transport_type: 'beacon'
            });
          }
          setTimeout(function () {
            const target = link.getAttribute('target');
            if (target && target !== '_self') {
              window.open(href, target);
            } else {
              window.location.href = href;
            }
          }, 150);
        });
      });
    });
  </script>
</body>
</html>
