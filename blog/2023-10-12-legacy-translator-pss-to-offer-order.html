
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>Legacy Translator: A Practical Bridge from PSS to Offer and Order Management</title>
<meta name="description" content="A practical guide to building a legacy translator to move from PSS to Offer and Order Management. Architecture, data mapping, risks, KPIs, and a phased roadmap."/>
<meta name="keywords" content="legacy translator, PSS, offer and order, offer order management, ONE Order, NDC, modern airline retailing, airline merchandising, order management system, airline digital transformation"/>
<meta property="og:title" content="Legacy Translator: A Practical Bridge from PSS to Offer and Order Management"/>
<meta property="og:description" content="How to connect today’s PSS to tomorrow’s offer and order world with a legacy translator: patterns, data, governance, and real-life tips."/>
<meta property="og:type" content="article"/>
<meta property="og:image" content="/blog/images/blog-legacy-translator-hero.jpg"/>
<meta property="og:url" content="https://www.modernairlineretailing.com/blog/2023-10-12-legacy-translator-pss-to-offer-order.html"/>
<meta name="twitter:card" content="summary_large_image"/>
<link rel="canonical" href="https://www.modernairlineretailing.com/blog/2023-10-12-legacy-translator-pss-to-offer-order.html"/>

<link rel="preconnect" href="https://cdn.jsdelivr.net"/>
<link rel="dns-prefetch" href="https://cdn.jsdelivr.net"/>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css"/>

<style>
/* Light, readable default */
:root {
  --bg: #f8fbff;
  --surface: #ffffff;
  --soft: #f2f7ff;
  --text: #0e2433;
  --text-dim: #314a63;
  --muted: #5a7896;
  --primary: #2b82f6;
  --primary-strong: #1c68d9;
  --accent: #11b5a4;
  --border: #dbe7f3;
  --link: #1a73e8;
  --link-hover: #0b5ed7;
  --focus: #ffbf47;

  --radius: 14px;
  --radius-sm: 10px;
  --shadow: 0 10px 24px rgba(16, 46, 83, 0.08);
  --shadow-soft: 0 6px 16px rgba(16, 46, 83, 0.06);

  --code-bg: #eef5ff;
  --code-inline: #e6f0ff;
  --table-head: #ebf3ff;

  --font-size: 18px;
  --lh: 1.75;
  --maxw: 980px;
}

/* Optional dark theme that stays readable */
html.dark {
  --bg: #0f1724;
  --surface: #122034;
  --soft: #15263e;
  --text: #eaf2fb;
  --text-dim: #d3deea;
  --muted: #b7c6d6;
  --primary: #6fb3ff;
  --primary-strong: #5aa2f3;
  --accent: #29d2c0;
  --border: #24425f;
  --link: #87c8ff;
  --link-hover: #b5ddff;
  --focus: #ffd166;
  --shadow: 0 10px 24px rgba(0,0,0,.25);
  --shadow-soft: 0 6px 16px rgba(0,0,0,.2);
  --code-bg: #0f2035;
  --code-inline: #122c44;
  --table-head: #19324e;
}

html { scroll-behavior: smooth; }
body {
  background: var(--bg);
  color: var(--text);
  font-family: ui-sans-serif, system-ui, -apple-system, "Inter", "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif;
  font-size: var(--font-size);
  line-height: var(--lh);
}

/* Reading progress bar */
#progress {
  position: fixed; top: 0; left: 0; height: 4px; width: 0%;
  background: linear-gradient(90deg, var(--primary), var(--accent));
  z-index: 9999; transition: width .15s ease-out;
}

/* Sticky top bar */
.topbar {
  position: sticky; top: 0; z-index: 1000;
  background: rgba(255,255,255,0.9);
  backdrop-filter: blur(8px);
  box-shadow: var(--shadow-soft);
  border-bottom: 1px solid var(--border);
}
html.dark .topbar { background: rgba(18,32,52,0.85); }

/* Hero with visible photo */
.hero-banner {
  background: #e9f2ff url('/blog/images/blog-legacy-translator-hero.jpg') center/cover no-repeat;
  position: relative; overflow: hidden;
}
.hero-banner::after {
  content: ""; position: absolute; inset: 0;
  background: linear-gradient(180deg, rgba(255,255,255,0), rgba(255,255,255,0.18));
}
html.dark .hero-banner::after {
  background: linear-gradient(180deg, rgba(0,0,0,0.08), rgba(0,0,0,0.28));
}
.hero-body { padding-top: 5rem; padding-bottom: 5rem; }
.hero .title, .hero .subtitle { color: var(--text); text-shadow: none; }
.hero .subtitle { color: var(--muted); }

/* Containers and content */
.container.content { max-width: var(--maxw); }
.content p { color: var(--text-dim); }
.content h1, .content h2, .content h3 { color: var(--text); }
.content h2 { margin-top: 2.2rem; }
.content h3 { margin-top: 1.4rem; }

/* Panels / cards */
.panel {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  color: var(--text);
}

/* TOC */
.toc-box {
  background: var(--surface);
  border: 1px solid var(--border);
  padding: 1rem 1.25rem;
  border-radius: var(--radius);
  font-size: .98rem;
  color: var(--text-dim);
}

/* Tags */
.tag-badge {
  display: inline-block;
  background: var(--soft);
  color: var(--text);
  padding: .4rem .7rem;
  margin: .2rem .25rem .2rem 0;
  border-radius: 999px;
  font-size: .72rem;
  letter-spacing: .4px;
  border: 1px solid var(--border);
}

/* Buttons and links */
.button.is-light { background: #ffffff; color: var(--text); border: 1px solid var(--border); }
.button.is-link { background: var(--primary); color: #fff; }
.button.is-link:hover { background: var(--primary-strong); }
a { color: var(--link); text-decoration: underline; text-underline-offset: 3px; }
a:hover { color: var(--link-hover); }
a.button { text-decoration: none; }
a:focus-visible, button:focus-visible { outline: 3px solid var(--focus); outline-offset: 2px; }

/* Tables */
.inline-table { border-collapse: collapse; width: 100%; font-size: .95rem; margin: 1rem 0; }
.inline-table th, .inline-table td { border: 1px solid var(--border); padding: .7rem .8rem; vertical-align: top; }
.inline-table thead { background: var(--table-head); }

/* Code */
pre {
  background: var(--code-bg); color: var(--text);
  padding: 1rem; border-radius: var(--radius-sm); overflow: auto; font-size: .92rem; border: 1px solid var(--border);
}
code { background: var(--code-inline); padding: .15rem .4rem; border-radius: 6px; }

/* Blockquote and callouts */
blockquote {
  border-left: 4px solid var(--primary);
  background: var(--soft);
  padding: 1rem 1.25rem;
  border-radius: var(--radius-sm);
  color: var(--text-dim);
}
.callout {
  border: 1px solid var(--border);
  background: var(--surface);
  padding: 1rem 1.25rem;
  border-radius: var(--radius);
  margin: 1.2rem 0;
  color: var(--text-dim);
}
.callout.success { border-color: #b9ebd8; background: #ecfdf6; color: #0f5132; }
.callout.warning { border-color: #ffe5b3; background: #fff8e7; color: #7a5a00; }
.callout.info { border-color: #cde2ff; background: #eef5ff; color: #0b3a74; }

/* Diagrams */
.diagram {
  background: var(--soft);
  border: 1px solid var(--border);
  padding: 1rem;
  border-radius: var(--radius-sm);
  font-size: .9rem;
  line-height: 1.35;
  overflow: auto;
  color: var(--text);
  white-space: pre-wrap;
}

/* Visual timeline */
.timeline {
  display: grid; gap: 1rem;
}
.timeline .step {
  display: grid; gap: .4rem;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 1rem;
  box-shadow: var(--shadow);
}
.step .label { font-weight: 700; color: var(--text); }
.step .desc { color: var(--text-dim); }

/* KPI cards */
.kpi-grid {
  display: grid; gap: 1rem; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
}
.kpi { background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius); padding: 1rem; box-shadow: var(--shadow); }
.kpi .num { font-size: 1.4rem; font-weight: 700; color: var(--primary); }
.kpi .cap { color: var(--text-dim); }

/* Fade-in */
.fade-in { opacity: 0; transform: translateY(8px); transition: opacity .5s ease, transform .5s ease; }
.fade-in.visible { opacity: 1; transform: translateY(0); }

/* Share FAB */
.share-fab {
  position: fixed; right: 18px; bottom: 18px; z-index: 1000;
  background: var(--primary);
  color: #fff; border: none; padding: .9rem 1rem;
  border-radius: 999px;
  box-shadow: var(--shadow);
  display: flex; gap: .5rem; align-items: center;
}
.share-fab:hover { background: var(--primary-strong); cursor: pointer; }
.share-menu {
  position: fixed; right: 18px; bottom: 70px; z-index: 1000;
  background: var(--surface); border: 1px solid var(--border);
  border-radius: var(--radius); box-shadow: var(--shadow); padding: .8rem; width: 300px; display: none; color: var(--text);
}
.share-menu.show { display: block; }
.share-row { display: flex; gap: .5rem; flex-wrap: wrap; }
.share-row a, .share-row button {
  border: 1px solid var(--border);
  background: var(--soft);
  padding: .5rem .7rem; border-radius: 999px; text-decoration: none; color: var(--text);
}
.share-copy { width: 100%; margin-top: .6rem; display: flex; gap: .5rem; }
.share-copy input { flex: 1; padding: .5rem .6rem; border: 1px solid var(--border); border-radius: 8px; background: #fff; color: var(--text); }
html.dark .share-copy input { background: var(--surface); }

/* Theme toggle */
.theme-toggle {
  border: 1px solid var(--border);
  background: var(--surface);
  color: var(--text);
  border-radius: 999px;
  padding: .45rem .8rem;
  font-size: .9rem;
}

/* FAQ details – force readable backgrounds and text */
details.panel {
  background: var(--surface) !important;
  border: 1px solid var(--border) !important;
  border-radius: var(--radius);
  color: var(--text) !important;
  padding: .8rem 1rem;
}
details.panel summary {
  color: var(--text) !important;
  cursor: pointer;
  list-style: none;
}
details.panel summary::-webkit-details-marker { display: none; }
details.panel summary::after {
  content: "▾";
  float: right;
  color: var(--muted);
  transition: transform .2s ease;
}
details[open].panel summary::after { transform: rotate(180deg); }
details.panel p, details.panel ul, details.panel li { color: var(--text-dim) !important; }

/* Print */
@media print {
  #progress, .topbar, .share-fab, .share-menu { display: none !important; }
  body { background: #fff; color: #000; }
  .hero, .hero-banner { background: none !important; }
  a { color: #000; text-decoration: none; }
}
</style>

<script type="application/ld+json">
{
  "@context":"https://schema.org",
  "@type":"Article",
  "headline":"Legacy Translator: A Practical Bridge from PSS to Offer and Order Management",
  "datePublished":"2023-10-12",
  "dateModified":"2023-10-12",
  "author":{"@type":"Person","name":"Modern Airline Retailing"},
  "image":"https://www.modernairlineretailing.com/blog/images/blog-legacy-translator-hero.jpg",
  "keywords":"legacy translator,PSS,offer order management,Offer and Order,ONE Order,modern airline retailing,airline OMS,NDC,migration roadmap,data mapping,RBD-less",
  "publisher":{"@type":"Organization","name":"Modern Airline Retailing"}
}
</script>
  <link rel="stylesheet" href="/assets/site.css"/>
  <link rel="stylesheet" href="/assets/post.css"/>
</head>
<body>
  <header class="site-header"></header>
  <main class="page-content">

<div id="progress" aria-hidden="true"></div>

<!-- Sticky top bar with Home + theme toggle + share -->
<div class="topbar">
  <nav class="container" style="max-width: var(--maxw); display:flex; align-items:center; justify-content:space-between; padding:.35rem 0;">
    <div>
      <a class="button is-light" href="/index.html" aria-label="Go to Home">Home</a>
    </div>
    <div style="display:flex; gap:.5rem; align-items:center;">
      <button class="theme-toggle" id="themeToggle" aria-pressed="false" aria-label="Toggle dark mode">Dark theme</button>
      <button class="button is-link" id="shareTop" aria-label="Share this page">Share</button>
    </div>
  </nav>
</div>

<section class="hero is-medium hero-banner" role="img" aria-label="Bridge between PSS and Offer and Order systems">
  <div class="hero-body">
    <div class="container" style="max-width: var(--maxw);">
      <h1 class="title">Legacy Translator: A Practical Bridge from PSS to Offer and Order Management</h1>
      <p class="subtitle">A step‑by‑step playbook for modern airline retailing</p>
      <div>
        <span class="tag-badge">Offer &amp; Order</span>
        <span class="tag-badge">Modern Airline Retailing</span>
        <span class="tag-badge">PSS</span>
        <span class="tag-badge">ONE Order</span>
        <span class="tag-badge">Roadmap</span>
      </div>
    </div>
  </div>
</section>

<section class="section">
  <div class="container content" style="max-width: var(--maxw);">

    <div class="toc-box panel fade-in" id="toc">
      <strong>Contents</strong>
      <ol style="margin-top:.6rem;">
        <li><a href="#summary">Simple Summary</a></li>
        <li><a href="#why-now">Why Now</a></li>
        <li><a href="#translator-basics">What a Legacy Translator Does</a></li>
        <li><a href="#reference-arch">Reference Architecture</a></li>
        <li><a href="#data-mapping">Data Mapping: PSS → Offer/Order</a></li>
        <li><a href="#flows">Key Flows</a></li>
        <li><a href="#governance">Governance, Risk, Compliance</a></li>
        <li><a href="#kpis">KPIs and Value Tracking</a></li>
        <li><a href="#phased-plan">Phased Plan</a></li>
        <li><a href="#patterns">Design Patterns and Anti‑Patterns</a></li>
        <li><a href="#faq">FAQ</a></li>
        <li><a href="#checklist">Checklist</a></li>
      </ol>
    </div>

    <h2 id="summary" class="fade-in">1) Simple Summary</h2>
    <p>A legacy translator lets you keep flying with your PSS while you move to offer and order management. It sits in the middle, translating between today’s PNR/ticket world and tomorrow’s offer/order world. You can start small, reduce risk, and grow capability without a big‑bang cutover.</p>

    <div class="diagram fade-in" aria-label="Bridge diagram">
Bridge Concept
────────────────────────────────────────────
Channels (Web, App, NDC, GDS)
            │
            ▼
     Offer/Order Layer (Offer Engine, OMS)
            │
            ▼
     Legacy Translator (Mapping + Rules)
            │
            ▼
 PSS (Availability, Fares, PNR, Ticketing)
    </div>

    <div class="callout info fade-in">
      Goal: decouple retailing speed from legacy constraints, while staying safe on accounting, interline, and regulatory needs.
    </div>

    <h2 id="why-now" class="fade-in">2) Why Now</h2>
    <ul>
      <li>Retail expectations are higher: people want clear products, bundles, and consistent prices.</li>
      <li>Offer and order standards are maturing, making it safer to move.</li>
      <li>You can show value fast: better conversion, new ancillaries, cleaner operations.</li>
    </ul>

    <h2 id="translator-basics" class="fade-in">3) What a Legacy Translator Does</h2>
    <ul>
      <li><strong>Vocabulary:</strong> Converts PSS concepts (RBD, PNR, e‑ticket, SSR) into offer and order terms (product attributes, offers, orders, services).</li>
      <li><strong>Compatibility:</strong> Keeps partners working (NDC, interline, codeshare) while you modernize.</li>
      <li><strong>Traceability:</strong> Maintains audit links between filed fares/taxes and your new offers and orders.</li>
    </ul>

    <h2 id="reference-arch" class="fade-in">4) Reference Architecture</h2>
    <div class="diagram" aria-label="Reference architecture diagram">
Reference Architecture (High Level)
────────────────────────────────────────────
[Channels] Web/App | Agency/NDC | Corporate | Call Center
        │
        ▼
[Offer Layer] Context + Pricing + Bundling
        │    ▲
        │    │  Caches/Signals (availability, demand, tax)
        ▼    │
[Legacy Translator]
  • Contract: APIs + events
  • Mapping: RBD/brand → attributes
  • Tokens: offer integrity
  • Fallbacks: discrete fare when needed
        │
        ▼
[PSS + Legacy Services]
  • Availability/Inventory
  • Fare/rules via ATPCO
  • PNR + Ticketing
  • EMD for ancillaries
    </div>

    <h2 id="data-mapping" class="fade-in">5) Data Mapping: PSS → Offer/Order</h2>
    <table class="inline-table panel">
      <thead><tr><th>PSS Field</th><th>Offer/Order Concept</th><th>Notes</th></tr></thead>
      <tbody>
        <tr><td>RBD (Y, B, M)</td><td>Attributes (flex, seat, bag)</td><td>Map to product features customers understand.</td></tr>
        <tr><td>PNR</td><td>Order</td><td>Order holds services; keep PNR link for audit until cutover.</td></tr>
        <tr><td>E‑ticket</td><td>Order item + fulfillment</td><td>Use ticket/EMD as fulfillment artifacts during hybrid phase.</td></tr>
        <tr><td>ATPCO fare/rules</td><td>Offer guardrails</td><td>Use for legality, combinability, and policy limits.</td></tr>
        <tr><td>SSR/OSI</td><td>Service attributes + notes</td><td>Normalize where possible (seats, meals, assistance).</td></tr>
      </tbody>
    </table>

    <div class="diagram fade-in" aria-label="Mapping example">
Mapping Example (Economy Flex)
────────────────────────────────────────────
PSS: RBD = Y, Fare Brand = Flex, AP/MinStay rules
→ Offer: Product = Economy Flex
   Attributes = [1 checked bag, free changes, front seat]
   Guardrails = from fare rules
→ Order: Items = [Base fare service, Bag service, Seat service]
   Fulfillment = Ticket + EMD references
    </div>

    <h2 id="flows" class="fade-in">6) Key Flows</h2>
    <ol>
      <li><strong>Search/Offer:</strong> Translator enriches offers with PSS constraints, maps to attributes, returns a token.</li>
      <li><strong>Book/Order:</strong> Token is validated; an order is created; PSS PNR/ticket/EMD is issued behind the scenes.</li>
      <li><strong>Change/After‑sales:</strong> Order change request maps back to PSS reissue rules; keep fees and taxes legal.</li>
      <li><strong>Interline:</strong> Use anchor fares and fair proration; fall back to filed points if a partner can’t process tokens.</li>
    </ol>

    <div class="diagram fade-in" aria-label="Sequence flow">
Sequence (Happy Path)
────────────────────────────────────────────
Customer → Search
Offer Engine → Translator → PSS (availability/fare rules)
Translator → Offer (price + brand + attributes + token)
Customer → Book
OMS → Token validate → Translator → PSS (PNR, ticket/EMD)
OMS → Order confirmed (with legacy references)
    </div>

    <h2 id="governance" class="fade-in">7) Governance, Risk, Compliance</h2>
    <ul>
      <li><strong>Audit trail:</strong> Every offer carries method (FILED/DYNAMIC/CONTINUOUS), data versions, and tax table versions.</li>
      <li><strong>Fairness:</strong> Avoid sensitive features in pricing signals; review models regularly.</li>
      <li><strong>Tax authority rules:</strong> Always call the tax engine; keep a record of versions and overrides.</li>
      <li><strong>SLAs:</strong> Token validation and PSS calls must meet strict latency targets to protect conversion.</li>
    </ul>

    <h2 id="kpis" class="fade-in">8) KPIs and Value Tracking</h2>
    <div class="kpi-grid fade-in">
      <div class="kpi">
        <div class="num">+2–5 pts</div>
        <div class="cap">Conversion uplift vs. control</div>
      </div>
      <div class="kpi">
        <div class="num">↓ 20–40%</div>
        <div class="cap">Checkout repricing events</div>
      </div>
      <div class="kpi">
        <div class="num">~10–25%</div>
        <div class="cap">Ancillary attach rate increase</div>
      </div>
      <div class="kpi">
        <div class="num">< 0.5%</div>
        <div class="cap">Guardrail breach rate</div>
      </div>
    </div>

    <h2 id="phased-plan" class="fade-in">9) Phased Plan</h2>
    <div class="timeline fade-in">
      <div class="step">
        <div class="label">Phase 1: Translate and Trace</div>
        <div class="desc">Keep PSS in charge of inventory and tickets. Translator maps brands and attributes, returns tokens, and logs anchors.</div>
      </div>
      <div class="step">
        <div class="label">Phase 2: Attribute‑First Bundles</div>
        <div class="desc">Sell by features (flex, bag, seat, priority). Keep legacy references for accounting and interline.</div>
      </div>
      <div class="step">
        <div class="label">Phase 3: RBD‑light</div>
        <div class="desc">Hide RBD from channels. Internally map to attribute capacity (e.g., flex seats left).</div>
      </div>
      <div class="step">
        <div class="label">Phase 4: Order‑Led</div>
        <div class="desc">Orders become the source of truth; tickets/EMDs persist as fulfillment artifacts or disappear per market rules.</div>
      </div>
    </div>

    <h2 id="patterns" class="fade-in">10) Design Patterns and Anti‑Patterns</h2>
    <table class="inline-table panel">
      <thead><tr><th>Pattern</th><th>Why it helps</th><th>Notes</th></tr></thead>
      <tbody>
        <tr><td>Tokenized offers</td><td>Fast checkout, fewer reprices</td><td>Short TTL; cryptographically signed</td></tr>
        <tr><td>Anchor trace</td><td>Audit and partner fallback</td><td>Store fare ref, rule refs, tax version</td></tr>
        <tr><td>Attribute capacity</td><td>Controls by product, not letters</td><td>Backed by PSS inventory early on</td></tr>
        <tr><td>Feature flags</td><td>Safe rollouts and rollbacks</td><td>Per route, channel, market</td></tr>
        <tr><td>Anti‑pattern: Big‑bang cutover</td><td>High risk, hard rollback</td><td>Prefer phased, with coexistence</td></tr>
        <tr><td>Anti‑pattern: Hidden discounts</td><td>Tax and partner issues</td><td>Keep rule‑compliant guardrails</td></tr>
      </tbody>
    </table>

    <h2 id="faq" class="fade-in">11) FAQ</h2>
    <details class="panel">
      <summary><strong>Is a legacy translator a permanent solution?</strong></summary>
      <p>No. It’s a bridge. It buys time and safety while you build confidence in offer and order. Over time, it should get thinner.</p>
    </details>
    <details class="panel" style="margin-top:.6rem;">
      <summary><strong>Do we need to rewrite our pricing?</strong></summary>
      <p>Not at once. Start by mapping brands and rules. Then add smarter selection and continuous pricing inside guardrails.</p>
    </details>
    <details class="panel" style="margin-top:.6rem;">
      <summary><strong>Will partners accept this?</strong></summary>
      <p>Yes, with fallbacks. Keep anchors for interline. Share tokens with partners who can use them; otherwise offer discrete steps.</p>
    </details>

    <h2 id="checklist" class="fade-in">12) Checklist</h2>
    <ul>
      <li>Define your attribute model (flexibility, seat, bag, priority).</li>
      <li>Map brands and RBDs to those attributes internally.</li>
      <li>Introduce tokenized offers with a short TTL and version tags.</li>
      <li>Track anchors and tax table versions for every offer.</li>
      <li>Set KPIs and feature flags per route and channel.</li>
      <li>Plan phased de‑emphasis of PNR/ticket in favor of orders.</li>
    </ul>

    <hr/>
    <nav class="level" aria-label="Article navigation">
      <div class="level-left">
        <a class="button is-link is-light" href="/blog/index.html">← All posts</a>
      </div>
      <div class="level-right">
        <a class="button is-link" href="/blog/2024-07-24-availability-translation-dynamic-offers.html">Next: Availability Translation for Dynamic Offers →</a>
      </div>
    </nav>
    <p><a href="/blog/index.html">Back to all blogs</a></p>

  </div>
</section>

<!-- Floating Share Button and Menu -->
<button class="share-fab" id="shareFab" aria-haspopup="true" aria-controls="shareMenu">
  <span aria-hidden="true">🔗</span> Share
</button>
<div class="share-menu" id="shareMenu" role="dialog" aria-modal="false" aria-label="Share this page">
  <div style="font-weight:600; margin-bottom:.4rem;">Share this page</div>
  <div class="share-row" aria-label="Quick share">
    <a id="shareTwitter" target="_blank" rel="noopener" aria-label="Share on X/Twitter">X/Twitter</a>
    <a id="shareLinkedIn" target="_blank" rel="noopener" aria-label="Share on LinkedIn">LinkedIn</a>
    <a id="shareFacebook" target="_blank" rel="noopener" aria-label="Share on Facebook">Facebook</a>
    <button id="nativeShare" aria-label="Use device share">Device Share</button>
  </div>
  <div class="share-copy">
    <input id="shareUrl" type="text" aria-label="Page URL to copy" readonly/>
    <button id="copyBtn" class="button is-light" aria-label="Copy link">Copy</button>
  </div>
</div>

<script>
/* Reading progress */
(function(){
  const bar = document.getElementById('progress');
  const update = () => {
    const h = document.documentElement;
    const s = h.scrollTop || document.body.scrollTop;
    const d = h.scrollHeight - h.clientHeight;
    const pct = Math.max(0, Math.min(1, s / d));
    bar.style.width = (pct * 100) + '%';
  };
  document.addEventListener('scroll', update, { passive: true });
  window.addEventListener('load', update);
})();

/* Fade-in on view */
(function() {
  const els = document.querySelectorAll('.fade-in');
  const io = new IntersectionObserver(entries => {
    entries.forEach(e => { if (e.isIntersecting) e.target.classList.add('visible'); });
  }, { threshold: 0.12 });
  els.forEach(el => io.observe(el));
})();

/* Theme toggle – default to LIGHT theme unless user already chose */
(function(){
  const btn = document.getElementById('themeToggle');

  function apply(theme) {
    document.documentElement.classList.toggle('dark', theme === 'dark');
    localStorage.setItem('theme', theme);
    btn.setAttribute('aria-pressed', String(theme === 'dark'));
    btn.textContent = theme === 'dark' ? 'Light theme' : 'Dark theme';
  }

  const saved = localStorage.getItem('theme');
  apply(saved ? saved : 'light'); // default light

  btn.addEventListener('click', () => {
    const nowDark = !document.documentElement.classList.contains('dark');
    apply(nowDark ? 'dark' : 'light');
  });
})();

/* Share helpers */
(function(){
  const currentUrl = window.location.href.split('#')[0];
  const title = document.title;
  const shareUrlInput = document.getElementById('shareUrl');
  shareUrlInput.value = currentUrl;

  const fab = document.getElementById('shareFab');
  const topBtn = document.getElementById('shareTop');
  const menu = document.getElementById('shareMenu');
  const copyBtn = document.getElementById('copyBtn');
  const nativeBtn = document.getElementById('nativeShare');

  const tw = document.getElementById('shareTwitter');
  const li = document.getElementById('shareLinkedIn');
  const fb = document.getElementById('shareFacebook');

  tw.href = 'https://twitter.com/intent/tweet?text=' + encodeURIComponent(title) + '&url=' + encodeURIComponent(currentUrl);
  li.href = 'https://www.linkedin.com/sharing/share-offsite/?url=' + encodeURIComponent(currentUrl);
  fb.href = 'https://www.facebook.com/sharer/sharer.php?u=' + encodeURIComponent(currentUrl);

  const toggleMenu = () => menu.classList.toggle('show');
  if (fab) fab.addEventListener('click', toggleMenu);
  if (topBtn) topBtn.addEventListener('click', toggleMenu);

  copyBtn.addEventListener('click', async () => {
    try {
      await navigator.clipboard.writeText(currentUrl);
      copyBtn.textContent = 'Copied!';
      setTimeout(() => copyBtn.textContent = 'Copy', 1300);
    } catch(e) {
      shareUrlInput.select();
      document.execCommand('copy');
      copyBtn.textContent = 'Copied!';
      setTimeout(() => copyBtn.textContent = 'Copy', 1300);
    }
  });

  nativeBtn.addEventListener('click', async () => {
    if (navigator.share) {
      try { await navigator.share({ title, url: currentUrl }); } catch(_) {}
    } else {
      toggleMenu();
    }
  });

  // Close on outside click
  document.addEventListener('click', (e) => {
    if (!menu.contains(e.target) && e.target !== fab && e.target !== topBtn) {
      menu.classList.remove('show');
    }
  }, true);
})();
</script>

  </main>
  <footer class="site-footer"></footer>
  <script src="/assets/site.js" defer></script>
</body>
</html>