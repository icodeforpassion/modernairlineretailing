<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ATPCO Fare Filing: Fares, Rules & Footnotes-A Practitioner's Guide</title>

  <!-- Meta -->
  <meta name="description" content="A practical, engineer-friendly guide to ATPCO fare filing: how fares, rules, footnotes, routing, surcharges and taxes work together-and how to implement them reliably while modernizing toward Offers & Orders."/>
  <link rel="canonical" href="https://www.modernairlineretailing.com/blog/2024-02-27-atpco-fare-filing-fares-rules-footnotes-practice.html"/>

  <!-- Open Graph -->
  <meta property="og:title" content="ATPCO Fare Filing: Fares & Rules-A Practitioner's Guide"/>
  <meta property="og:description" content="How to make sense of ATPCO fare filing in real systems: fares, rules, footnotes, routing, YQ/YR, taxes, pricing checks, and modernization."/>
  <meta property="og:type" content="article"/>
  <meta property="og:image" content="https://www.modernairlineretailing.com/blog/images/blog-3.jpg"/>
  <meta property="og:url" content="https://www.modernairlineretailing.com/blog/2024-02-27-atpco-fare-filing-fares-rules-footnotes-practice.html"/>

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image"/>

  <!-- Styles -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css"/>
  <style>
    .hero-banner { background: linear-gradient(135deg,#eff6ff 0%,#ffffff 75%); color:#0f172a; border-bottom:1px solid #e2e8f0; }
    .overlay { background: transparent; padding: 3rem 1.5rem; }
    .hero-banner .title,
    .hero-banner .subtitle { color:#0f172a; }
    .home-btn { position: relative; top:auto; display:inline-block; margin:0.5rem 0 1.5rem; }
    .content p { line-height: 1.75; color:#0f172a; }
    .content pre { background:#f1f5f9; color:#0f172a; padding:1rem; overflow:auto; font-size:.95rem; border-radius:8px; border:1px solid #dbeafe; }
    .content code { background:#e2e8f0; color:#0f172a; padding:.15rem .4rem; border-radius:4px; font-size:.9em; }
    .toc-box { background:#f8fafc; border:1px solid #dbeafe; padding:1rem 1.25rem; border-radius:10px; font-size:.95rem; color:#0f172a; }
    .tag-badge { display:inline-block; background:#e0f2fe; color:#1d4ed8; padding:.25rem .6rem; margin:.15rem .35rem .15rem 0; border-radius:999px; font-size:.7rem; letter-spacing:.4px; text-transform:uppercase; font-weight:600; }
    table { font-size:.95rem; }
    table thead { background:#e0f2fe; }
    table th, table td { border:1px solid #dbeafe; }
    blockquote { border-left:4px solid #2563eb; background:#eff6ff; padding:1rem 1.25rem; border-radius:6px; color:#0f172a; }
    .callout { border:1px solid #facc15; background:#fef9c3; padding:1rem 1.25rem; border-radius:10px; margin:1.5rem 0; color:#7c2d12; }
    .callout.warning { border-color:#f97316; background:#fff7ed; color:#7c2d12; }
    .mini-caption { font-size:.75rem; text-transform:uppercase; letter-spacing:.5px; opacity:.8; margin-top:.35rem; color:#475569; }
    .section-nav { margin-top:3rem; }
    .sr-only { position:absolute; left:-9999px; top:auto; width:1px; height:1px; overflow:hidden; }
  </style>

  <!-- Schema.org -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"Article",
    "headline":"ATPCO Fare Filing: Fares, Rules & Footnotes-A Practitioner's Guide",
    "description":"A practical, engineer-friendly guide to ATPCO fare filing: how fares, rules, footnotes, routing, surcharges and taxes work together-and how to implement them reliably while modernizing toward Offers & Orders.",
    "datePublished":"2024-02-27",
    "dateModified":"2024-02-27",
    "author":{"@type":"Person","name":"Modern Airline Retailing"},
    "image":"https://www.modernairlineretailing.com/blog/images/blog-3.jpg",
    "publisher":{"@type":"Organization","name":"Modern Airline Retailing"},
    "mainEntityOfPage":{"@type":"WebPage","@id":"https://www.modernairlineretailing.com/blog/2024-02-27-atpco-fare-filing-fares-rules-footnotes-practice.html"},
    "articleSection":"Airline Pricing",
    "keywords":"ATPCO,fare filing,fare rules,footnotes,routing,MPM,HIP,YQ,YR,taxes,airline pricing,offers & orders"
  }
  </script>
  <link rel="stylesheet" href="/assets/site.css"/>
  <link rel="stylesheet" href="/assets/post.css"/>
</head>
<body>
  <header class="site-header"></header>
  <main class="page-content">
  <section class="hero is-medium hero-banner" role="img" aria-label="ATPCO fare filing illustration">
    <div class="hero-body overlay">
      <div class="container">
        <a class="button is-link is-light home-btn" href="/index.html">Home</a>
        <h1 class="title">ATPCO Fare Filing: Fares, Rules & Footnotes-A Practitioner's Guide</h1>
        <p class="subtitle">February 27, 2024 • ~18 min read</p>
        <div>
          <span class="tag-badge">Pricing</span>
          <span class="tag-badge">ATPCO</span>
          <span class="tag-badge">Fare Rules</span>
          <span class="tag-badge">Implementation</span>
        </div>
      </div>
    </div>
  </section>

  <section class="section">
    <div class="container content">
      <div class="toc-box">
        <strong>Contents</strong>
        <ol style="margin-top:.6rem;">
          <li><a href="#why-it-matters">Why this still matters</a></li>
          <li><a href="#lifecycle">How fare data flows</a></li>
          <li><a href="#data-building-blocks">The core building blocks</a></li>
          <li><a href="#rule-categories">Rule categories (plain English)</a></li>
          <li><a href="#footnotes">Footnotes, without the mystery</a></li>
          <li><a href="#routing">Routing vs MPM (and construction)</a></li>
          <li><a href="#surcharges-taxes">YQ/YR, Cat 12, and taxes</a></li>
          <li><a href="#pricing-workflow">A realistic pricing workflow</a></li>
          <li><a href="#integrity-checks">Keeping prices honest</a></li>
          <li><a href="#caching-distribution">Caching what actually helps</a></li>
          <li><a href="#common-failures">Frequent failure modes</a></li>
          <li><a href="#engineering-patterns">Engineering patterns that work</a></li>
          <li><a href="#modernization">Bridging to Offers & Orders</a></li>
          <li><a href="#continuous-pricing">Where continuous pricing fits</a></li>
          <li><a href="#monitoring">What to monitor</a></li>
          <li><a href="#checklist">A short implementation checklist</a></li>
          <li><a href="#glossary">Mini glossary</a></li>
          <li><a href="#sources">Sources & further reading</a></li>
          <li><a href="#disclaimer">Disclaimer</a></li>
        </ol>
      </div>

      <p>
        If you build airline retail or pricing systems, ATPCO fare filing isn’t “legacy noise”-it’s the rulebook most
        of the ecosystem still plays by. Even if you’re racing toward dynamic Offers & Orders, the filed world powers
        interline, agency distribution, and servicing. Understanding it well makes modernization safer and faster.
      </p>

      <h2 id="why-it-matters">1) Why this still matters</h2>
      <ul>
        <li><strong>It encodes policy, not just prices.</strong> Advance purchase, seasonality, who can buy, how you can combine-filed data describes the product you intend to sell, consistently, in every channel.</li>
        <li><strong>It keeps you interoperable.</strong> GDSs, pricers, and settlement rely on shared semantics; filed fares are the lingua franca across carriers.</li>
        <li><strong>It protects servicing and compliance.</strong> Refunds, changes, taxes, and disclosures lean on what you filed. Skip it, and you invite ADMs and disputes.</li>
      </ul>
      <blockquote>
        Modern pitfall: jumping straight to dynamic pricing without a bridge to filed fares. You’ll ship faster-and break more-than you expect.
      </blockquote>

      <h2 id="lifecycle">2) How fare data flows</h2>
      <ol>
        <li><strong>Authoring.</strong> Pricing/RM define base fares, attach rules and footnotes, and prepare batches.</li>
        <li><strong>ATPCO processing & distribution.</strong> Validation, normalization, and distribution to subscribed systems (GDS, pricing engines, tax engines, data lakes). This is a source of timing/latency mismatch.</li>
        <li><strong>Shopping & pricing.</strong> Engines combine itinerary + inventory (RBD) + your filed data to form priceable candidates.</li>
        <li><strong>Ticketing & settlement.</strong> Fare basis, endorsements, amounts, and references make it onto the ticket/EMD and drive reissues, refunds, proration, and clearing.</li>
      </ol>
      <p><strong>Reality check:</strong> Every hop (authoring → ATPCO → cache → seller) is a chance for your price to drift from host inventory. Design for it.</p>

      <h2 id="data-building-blocks">3) The core building blocks</h2>
      <ul>
        <li><strong>Fare record (base fare).</strong> Market, direction (OW/RT), currency, tariff, rule number, footnotes, dates, public/private flag, etc.</li>
        <li><strong>Fare basis code.</strong> Short-hand label customers never see fully; the rules clarify its meaning.</li>
        <li><strong>Rule number.</strong> Points to reusable rule content (categories).</li>
        <li><strong>Footnotes.</strong> A way to share or scope conditions across multiple fares without duplicating data.</li>
        <li><strong>RBD mapping.</strong> The inventory class a fare requires (e.g., Y, M, J). If the bucket closes, the fare isn’t usable.</li>
        <li><strong>Optional Services & Branded Fares.</strong> Filed separately; used to define brand attributes and ancillaries in a standard way.</li>
        <li><strong>Constructed, Cat 25/Cat 35.</strong> Build fares from parts (add-ons), transform bases, or carry negotiated/private amounts.</li>
      </ul>

      <h2 id="rule-categories">4) Rule categories (plain English)</h2>
      <p>Categories are just named chunks of logic. Here are the heavy hitters you’ll actually implement:</p>
      <table class="table is-fullwidth is-striped is-hoverable">
        <thead>
          <tr><th>Cat</th><th>What it’s about</th><th>What to watch for</th></tr>
        </thead>
        <tbody>
          <tr><td>1</td><td>Eligibility</td><td>PAX type, residency, corporate ID. Quick early filter.</td></tr>
          <tr><td>2</td><td>Day/Time</td><td>Local time windows; time zones matter.</td></tr>
          <tr><td>3</td><td>Seasonality</td><td>Travel start windows; normalize to intervals.</td></tr>
          <tr><td>4</td><td>Flight Application</td><td>Specific flights/equipment; match to schedules.</td></tr>
          <tr><td>5</td><td>Advance Purchase</td><td>Book-by dates; evaluate at quote and at ticketing.</td></tr>
          <tr><td>6</td><td>Minimum Stay</td><td>Often “Sat night” or X days.</td></tr>
          <tr><td>7</td><td>Maximum Stay</td><td>Return time limits.</td></tr>
          <tr><td>8</td><td>Stopovers</td><td>Count/charges; interacts with Cat 12 surcharges.</td></tr>
          <tr><td>9</td><td>Transfers</td><td>Connection limits; prunes awkward itineraries.</td></tr>
          <tr><td>10</td><td>Combinability</td><td>Half-round-trip and end-on-end logic; core to multi-fare trips.</td></tr>
          <tr><td>12</td><td>Surcharges</td><td>Rule-level fees (distinct from YQ/YR).</td></tr>
          <tr><td>14</td><td>Travel Restrictions</td><td>Blackouts, directional sequences.</td></tr>
          <tr><td>15</td><td>Sales Restrictions</td><td>POS/POT; channel gating.</td></tr>
          <tr><td>16</td><td>Penalties</td><td>Change/refund conditions (free text if not using 31/33).</td></tr>
          <tr><td>17</td><td>HIP/Mileage Exceptions</td><td>Overrides to higher-intermediate-point checks.</td></tr>
          <tr><td>31</td><td>Voluntary Changes</td><td>Structured change rules; newer, machine-friendly.</td></tr>
          <tr><td>33</td><td>Voluntary Refunds</td><td>Structured refund rules; automates refunds.</td></tr>
          <tr><td>25</td><td>Fare By Rule</td><td>Programmatic transforms-discount/markup off bases.</td></tr>
          <tr><td>35</td><td>Negotiated</td><td>Private/net fares with access controls.</td></tr>
        </tbody>
      </table>

      <h2 id="footnotes">5) Footnotes, without the mystery</h2>
      <p>
        Footnotes are a scoping tool. A fare references a footnote code; that code maps to rows of category data that
        apply only when that footnote is present. The engine merges “base rule” + “footnote rows” before evaluation.
      </p>
      <p class="mini-caption">Tip: cache a compiled rule keyed by <code>hash(ruleNumber + sortedFootnotes)</code> to avoid re-merging on every quote.</p>

      <h2 id="routing">6) Routing vs MPM (and construction)</h2>
      <ul>
        <li><strong>Routing numbers.</strong> A fare can point to a routing that spells out allowable paths (via cities, carriers, sometimes equipment). Think of it as a tiny grammar the itinerary must match.</li>
        <li><strong>Maximum Permitted Mileage (MPM).</strong> Mileage-based validity: you’re good if the flown (with allowed tolerance) fits within the published cap for that market.</li>
      </ul>
      <p>
        Constructed pricing stitches fare halves (e.g., domestic add-on + international half). After construction, run
        HIP (Higher Intermediate Point) and circle trip checks so you don’t under-collect versus an intermediate city.
      </p>

      <h2 id="surcharges-taxes">7) YQ/YR, Cat 12, and taxes</h2>
      <ul>
        <li><strong>Carrier-imposed surcharges (YQ/YR).</strong> Filed separately and applied under conditions (market, cabin, etc.). They’re not the base fare but commonly shown with it.</li>
        <li><strong>Category 12 surcharges.</strong> Rule-driven fees (e.g., specific DOW/season) that get applied before tax.</li>
        <li><strong>Taxes.</strong> Driven by tax points and jurisdiction rules; accuracy matters for settlement. Use an authoritative tax feed/engine; don’t home-roll.</li>
      </ul>
      <p><strong>Rounding:</strong> Obey currency and market rounding rules; keep unrounded audit values.</p>

      <h2 id="pricing-workflow">8) A realistic pricing workflow</h2>
      <pre><code>Input: O&D, dates, pax types, cabin, corp codes, itinerary shape

1. Get availability (RBD per segment).
2. Build candidate itineraries (time, connection, alliance constraints).
3. Fetch fare candidates by market/cabin/effective dates/POS.
4. Compile rules (base + footnotes) into a fast structure.
5. Fast filters: Cat 2/3/5/15 to shrink the set early.
6. Map itinerary to fare components; validate routing or MPM.
7. Deep checks: Cat 6/7, Cat 8/9, Cat 10, HIP/circle trip.
8. Add Cat 12 surcharges, then YQ/YR, then taxes via tax engine.
9. Normalize currency & rounding; emit a detailed pricing trace.</code></pre>

      <h2 id="integrity-checks">9) Keeping prices honest</h2>
      <ul>
        <li><strong>Determinism.</strong> Same dataset + same itinerary → same price. Hash the compiled rule set and surface it.</li>
        <li><strong>Availability vs price drift.</strong> Detect when required RBD shut after quote; reprice on commit and flag staleness.</li>
        <li><strong>HIP under-collection.</strong> Regression tests for multi-city and constructed scenarios.</li>
        <li><strong>Tax drift.</strong> Daily diffs against the authoritative tax engine; alert on variance beyond tolerance.</li>
      </ul>

      <h2 id="caching-distribution">10) Caching what actually helps</h2>
      <p>Cache compiled rules and light metadata, not whole priced itineraries. Invalidate by ATPCO deltas, expose dataset timestamps, and publish a “staleness” metric with each response.</p>

      <h2 id="common-failures">11) Frequent failure modes</h2>
      <table class="table is-fullwidth">
        <thead><tr><th>What goes wrong</th><th>Why it happens</th><th>How to prevent it</th></tr></thead>
        <tbody>
          <tr><td>Quote ≠ ticket</td><td>Stale Cat 5 or closed RBD between steps</td><td>Short quote validity; reprice at commit; verify dataset version</td></tr>
          <tr><td>Penalty confusion</td><td>Cat 16 free-text; partial Cat 31/33 adoption</td><td>Prefer structured rules; clear customer copy if parsed text is ambiguous</td></tr>
          <tr><td>Under-collection on circles</td><td>Skipped HIP/circle trip logic</td><td>Automate tests on known tricky markets</td></tr>
          <tr><td>Wrong taxes on edges</td><td>Outdated tax tables or stopover detection bugs</td><td>Automated diffs; timezone-aware stopover logic</td></tr>
          <tr><td>Reload latency spikes</td><td>Mass recompiles in the hot path</td><td>JIT compile + LRU cache; pre-warm popular composites</td></tr>
        </tbody>
      </table>

      <h2 id="engineering-patterns">12) Engineering patterns that work</h2>
      <h3>12.1 Normalize your internal model</h3>
      <pre><code>Fare { id, O, D, dir, fareBasis, primaryRBD, tariff, ruleNumber,
       effective, expire, travelStart[], travelEnd[], private, ccy, amount, ptcs[], footnotes[] }

CompiledRule { key, ruleNumber, footnoteSet[], categories{...}, provenance{versions...} }

Availability { segmentKey -> { RBD: seats, updatedAt } }

PricingTrace { itinerarySig, fareComponents[], appliedCats[], surcharges[], taxes[], datasetVersion }</code></pre>

      <h3>12.2 Evaluation strategy</h3>
      <ul>
        <li><strong>Cheap first.</strong> Cat 2/3/5/15 as early filters.</li>
        <li><strong>Then shape.</strong> Apply routing/MPM once the itinerary is known.</li>
        <li><strong>Then cross-fare.</strong> Combinability, HIP, circles after components are built.</li>
        <li><strong>Service again later.</strong> Re-evaluate penalties/refunds at reissue time; keep the original snapshot.</li>
      </ul>

      <h2 id="modernization">13) Bridging to Offers & Orders</h2>
      <ul>
        <li><strong>Bridge service.</strong> Produce an Offer that either references a filed fare basis or a true dynamic bundle, but returns a unified schema.</li>
        <li><strong>Lineage.</strong> For filed offers include <code>fareBasis</code>, <code>ruleRefs</code>, and dataset version; for dynamic include algorithm ID/inputs.</li>
        <li><strong>Interline reality.</strong> Partners often still expect filed attributes-carry a dual representation until the network moves.</li>
        <li><strong>Explainability.</strong> If you “nudge” a filed ladder with continuous pricing, store the base and the delta, clearly.</li>
      </ul>

      <h2 id="continuous-pricing">14) Where continuous pricing fits</h2>
      <ul>
        <li>Use the filed fare as an <em>anchor</em>; apply a controlled, auditable adjustment.</li>
        <li>Respect tax computation rules and re-calculate accordingly.</li>
        <li>Set guardrails per market; on uncertainty, fall back to filed.</li>
      </ul>

      <h2 id="monitoring">15) What to monitor</h2>
      <ul>
        <li><strong>Data freshness.</strong> Last ATPCO load, delta lag, compile backlog.</li>
        <li><strong>Discrepancy sampling.</strong> Spot-check priced vs host.</li>
        <li><strong>Category pass/fail rates.</strong> Spikes reveal data regressions.</li>
        <li><strong>Latency budget.</strong> Stage-by-stage timings and cache hit ratio.</li>
        <li><strong>Servicing success.</strong> How often change/refund automation works vs manual fallback.</li>
      </ul>

      <h2 id="checklist">16) A short implementation checklist</h2>
      <ul>
        <li>Map lineage: fare → rule(s) → footnote(s) → compiled categories.</li>
        <li>Define an itinerary signature (airport + flight + date + cabin).</li>
        <li>Hash compiled rules into the response for reproducibility.</li>
        <li>Separate cheap filters from routing/HIP/Cat 10 work.</li>
        <li>Emit a human+machine pricing trace.</li>
        <li>Regression test HIP/circles and constructed cases.</li>
        <li>Detect availability drift and stale datasets.</li>
        <li>Keep a rollback plan for bad loads.</li>
        <li>Set allowed deviation from the filed ladder for continuous pricing.</li>
        <li>Automate tax-engine updates with comparisons.</li>
        <li>Expose an error taxonomy (e.g., <code>ROUTING_FAIL</code>, <code>ADV_PURCHASE_FAIL</code>, <code>TAX_ENGINE_ERROR</code>).</li>
      </ul>

      <h2 id="glossary">17) Mini glossary</h2>
      <ul>
        <li><strong>ATPCO:</strong> Industry platform distributing fares, rules, taxes, optional services to subscribed systems.</li>
        <li><strong>Fare basis code:</strong> Encodes fare family and conditions; rules provide the full meaning.</li>
        <li><strong>RBD:</strong> Inventory booking class (Y, M, J…); required seat bucket for a fare.</li>
        <li><strong>HIP:</strong> Higher Intermediate Point-prevents charging less than an intermediate fare on the path.</li>
        <li><strong>MPM:</strong> Maximum Permitted Mileage-cap on mileage for a market used in fare construction/validation.</li>
        <li><strong>YQ/YR:</strong> Carrier-imposed surcharges (distinct from government taxes).</li>
        <li><strong>Cat 25 / Cat 35:</strong> Fare-by-Rule transformations; negotiated/private fares.</li>
      </ul>

      <h2 id="sources">18) Sources & further reading</h2>
      <ul>
        <li>ATPCO: <em>What are ATPCO fare rules categories?</em></li>
        <li>ATPCO: Branded Fares & Optional Services overviews.</li>
        <li>IATA: Maximum Permitted Mileage (MPM) manual and mileage suite.</li>
        <li>Travelport & Amadeus support docs on Cat 25, YQ/YR, mileage, and HIP.</li>
        <li>Industry primers on HIP and fare construction logic.</li>
      </ul>
      <p class="mini-caption">These are concept primers. For operational details, use your licensed documentation and data feeds.</p>

      <h2 id="disclaimer">19) Disclaimer</h2>
      <div class="callout warning">
        This article is for product and engineering orientation. It does not reproduce proprietary ATPCO specifications or paid datasets. Always validate against your airline’s licensed ATPCO/IATA documentation, local regulations, and internal revenue accounting policies.
        <br/><br/>
        <strong>Transparency note:</strong> AI assistance was used to draft and edit this article; all facts and recommendations were reviewed for accuracy and relevance before publication.
      </div>

      <hr/>
      <nav class="level section-nav">
        <div class="level-left">
          <a class="button is-link is-light" href="/blog/2024-02-05-from-tty-to-edifact-structuring-airline-messages.html">← Previous</a>
        </div>
        <div class="level-right">
          <a class="button is-link" href="/blog/2024-03-20-availability-controls-oandd-nesting-and-married-segments.html">Next →</a>
        </div>
      </nav>
      <p><a href="/blog/index.html">Back to all blogs</a></p>

      <!-- Hidden image (for accessibility crawlers if you keep the background) -->
      <img class="sr-only" src="/blog/images/blog-3.jpg" alt="ATPCO fare filing illustration"/>
    </div>
  </section>
  </main>
  <footer class="site-footer"></footer>
  <script src="/assets/site.js" defer></script>
  <!-- Analytics configuration notes: Ensure GA4 Enhanced Measurement (including "Outbound clicks") remains enabled, validate tag deployment via https://tagassistant.google.com, monitor linkedin_redirect under GA4 → Reports → Engagement → Events, and mark it as a conversion in GA4 Admin → Events if desired. -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const linkedInLinks = document.querySelectorAll('a[href*="linkedin.com"]');
      linkedInLinks.forEach(function (link) {
        link.addEventListener('click', function (event) {
          if (event.defaultPrevented || event.button !== 0 || event.metaKey || event.ctrlKey || event.shiftKey || event.altKey) {
            return;
          }
          const href = link.href;
          event.preventDefault();
          if (typeof gtag === 'function') {
            gtag('event', 'linkedin_redirect', {
              event_category: 'Outbound',
              event_label: href,
              transport_type: 'beacon'
            });
          }
          setTimeout(function () {
            const target = link.getAttribute('target');
            if (target && target !== '_self') {
              window.open(href, target);
            } else {
              window.location.href = href;
            }
          }, 150);
        });
      });
    });
  </script>
</body>
</html>
