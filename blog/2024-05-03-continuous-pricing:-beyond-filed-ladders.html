
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>Continuous Pricing: Beyond Filed Ladders</title>
<meta name="description" content="A simple, practical guide to moving from fare ladders to dynamic and continuous pricing. What it is, why it helps, how to roll it out safely, and what to watch."/>
<meta property="og:title" content="Continuous Pricing: Beyond Filed Ladders"/>
<meta property="og:description" content="From fare ladders to continuous pricing: clear definitions, how it works with ATPCO, a safe transition plan, and real-world tips."/>
<meta property="og:type" content="article"/>
<meta property="og:image" content="/blog/images/blog-6-hero-wide.jpg"/>
<meta property="og:url" content="https://www.modernairlineretailing.com/blog/2024-05-03-continuous-pricing-beyond-filed-ladders.html"/>
<meta name="twitter:card" content="summary_large_image"/>
<link rel="canonical" href="https://www.modernairlineretailing.com/blog/2024-05-03-continuous-pricing-beyond-filed-ladders.html"/>

<link rel="preconnect" href="https://cdn.jsdelivr.net"/>
<link rel="dns-prefetch" href="https://cdn.jsdelivr.net"/>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css"/>

<style>
/* Light, readable default */
:root {
  --bg: #f8fbff;
  --surface: #ffffff;
  --soft: #f2f7ff;
  --text: #0e2433;
  --text-dim: #314a63;
  --muted: #5a7896;
  --primary: #2b82f6;
  --primary-strong: #1c68d9;
  --accent: #11b5a4;
  --border: #dbe7f3;
  --link: #1a73e8;
  --link-hover: #0b5ed7;
  --focus: #ffbf47;

  --radius: 14px;
  --radius-sm: 10px;
  --shadow: 0 10px 24px rgba(16, 46, 83, 0.08);
  --shadow-soft: 0 6px 16px rgba(16, 46, 83, 0.06);

  --code-bg: #eef5ff;
  --code-inline: #e6f0ff;
  --table-head: #ebf3ff;

  --font-size: 18px;
  --lh: 1.75;
  --maxw: 980px;
}

/* Optional dark theme that stays readable */
html.dark {
  --bg: #0f1724;
  --surface: #122034;
  --soft: #15263e;
  --text: #eaf2fb;
  --text-dim: #d3deea;
  --muted: #b7c6d6;
  --primary: #6fb3ff;
  --primary-strong: #5aa2f3;
  --accent: #29d2c0;
  --border: #24425f;
  --link: #87c8ff;
  --link-hover: #b5ddff;
  --focus: #ffd166;
  --shadow: 0 10px 24px rgba(0,0,0,.25);
  --shadow-soft: 0 6px 16px rgba(0,0,0,.2);
  --code-bg: #0f2035;
  --code-inline: #122c44;
  --table-head: #19324e;
}

html { scroll-behavior: smooth; }
body {
  background: var(--bg);
  color: var(--text);
  font-family: ui-sans-serif, system-ui, -apple-system, "Inter", "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif;
  font-size: var(--font-size);
  line-height: var(--lh);
}

/* Reading progress bar */
#progress {
  position: fixed; top: 0; left: 0; height: 4px; width: 0%;
  background: linear-gradient(90deg, var(--primary), var(--accent));
  z-index: 9999; transition: width .15s ease-out;
}

/* Sticky top bar */
.topbar {
  position: sticky; top: 0; z-index: 1000;
  background: rgba(255,255,255,0.9);
  backdrop-filter: blur(8px);
  box-shadow: var(--shadow-soft);
  border-bottom: 1px solid var(--border);
}
html.dark .topbar { background: rgba(18,32,52,0.85); }

/* Hero with visible photo */
.hero-banner {
  background: #e9f2ff url('/blog/images/blog-6-hero-wide.jpg') center/cover no-repeat;
  position: relative; overflow: hidden;
}
.hero-banner::after {
  content: ""; position: absolute; inset: 0;
  /* light overlay so the photo is visible in light mode */
  background: linear-gradient(180deg, rgba(255,255,255,0), rgba(255,255,255,0.18));
}
html.dark .hero-banner::after {
  /* gentle overlay in dark mode, still shows image */
  background: linear-gradient(180deg, rgba(0,0,0,0.08), rgba(0,0,0,0.28));
}
.hero-body { padding-top: 5rem; padding-bottom: 5rem; }
.hero .title, .hero .subtitle { color: var(--text); text-shadow: none; }
.hero .subtitle { color: var(--muted); }

/* Containers and content */
.container.content { max-width: var(--maxw); }
.content p { color: var(--text-dim); }
.content h1, .content h2, .content h3 { color: var(--text); }
.content h2 { margin-top: 2.2rem; }
.content h3 { margin-top: 1.4rem; }

/* Panels / cards */
.panel {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  color: var(--text);
}

/* TOC */
.toc-box {
  background: var(--surface);
  border: 1px solid var(--border);
  padding: 1rem 1.25rem;
  border-radius: var(--radius);
  font-size: .98rem;
  color: var(--text-dim);
}

/* Tags */
.tag-badge {
  display: inline-block;
  background: var(--soft);
  color: var(--text);
  padding: .4rem .7rem;
  margin: .2rem .25rem .2rem 0;
  border-radius: 999px;
  font-size: .72rem;
  letter-spacing: .4px;
  border: 1px solid var(--border);
}

/* Buttons and links */
.button.is-light { background: #ffffff; color: var(--text); border: 1px solid var(--border); }
.button.is-link { background: var(--primary); color: #fff; }
.button.is-link:hover { background: var(--primary-strong); }
a { color: var(--link); text-decoration: underline; text-underline-offset: 3px; }
a:hover { color: var(--link-hover); }
a.button { text-decoration: none; }
a:focus-visible, button:focus-visible { outline: 3px solid var(--focus); outline-offset: 2px; }

/* Tables */
.inline-table { border-collapse: collapse; width: 100%; font-size: .95rem; margin: 1rem 0; }
.inline-table th, .inline-table td { border: 1px solid var(--border); padding: .7rem .8rem; vertical-align: top; }
.inline-table thead { background: var(--table-head); }

/* Code */
pre {
  background: var(--code-bg); color: var(--text);
  padding: 1rem; border-radius: var(--radius-sm); overflow: auto; font-size: .92rem; border: 1px solid var(--border);
}
code { background: var(--code-inline); padding: .15rem .4rem; border-radius: 6px; }

/* Blockquote and callouts */
blockquote {
  border-left: 4px solid var(--primary);
  background: var(--soft);
  padding: 1rem 1.25rem;
  border-radius: var(--radius-sm);
  color: var(--text-dim);
}
.callout {
  border: 1px solid var(--border);
  background: var(--surface);
  padding: 1rem 1.25rem;
  border-radius: var(--radius);
  margin: 1.2rem 0;
  color: var(--text-dim);
}
.callout.success { border-color: #b9ebd8; background: #ecfdf6; color: #0f5132; }
.callout.warning { border-color: #ffe5b3; background: #fff8e7; color: #7a5a00; }

/* Diagrams */
.diagram {
  background: var(--soft);
  border: 1px solid var(--border);
  padding: 1rem;
  border-radius: var(--radius-sm);
  font-size: .9rem;
  line-height: 1.35;
  overflow: auto;
  color: var(--text);
}

/* Fade-in */
.fade-in { opacity: 0; transform: translateY(8px); transition: opacity .5s ease, transform .5s ease; }
.fade-in.visible { opacity: 1; transform: translateY(0); }

/* Share FAB */
.share-fab {
  position: fixed; right: 18px; bottom: 18px; z-index: 1000;
  background: var(--primary);
  color: #fff; border: none; padding: .9rem 1rem;
  border-radius: 999px;
  box-shadow: var(--shadow);
  display: flex; gap: .5rem; align-items: center;
}
.share-fab:hover { background: var(--primary-strong); cursor: pointer; }
.share-menu {
  position: fixed; right: 18px; bottom: 70px; z-index: 1000;
  background: var(--surface); border: 1px solid var(--border);
  border-radius: var(--radius); box-shadow: var(--shadow); padding: .8rem; width: 300px; display: none; color: var(--text);
}
.share-menu.show { display: block; }
.share-row { display: flex; gap: .5rem; flex-wrap: wrap; }
.share-row a, .share-row button {
  border: 1px solid var(--border);
  background: var(--soft);
  padding: .5rem .7rem; border-radius: 999px; text-decoration: none; color: var(--text);
}
.share-copy { width: 100%; margin-top: .6rem; display: flex; gap: .5rem; }
.share-copy input { flex: 1; padding: .5rem .6rem; border: 1px solid var(--border); border-radius: 8px; background: #fff; color: var(--text); }
html.dark .share-copy input { background: var(--surface); }

/* Theme toggle */
.theme-toggle {
  border: 1px solid var(--border);
  background: var(--surface);
  color: var(--text);
  border-radius: 999px;
  padding: .45rem .8rem;
  font-size: .9rem;
}

/* FAQ details – force readable backgrounds and text */
details.panel {
  background: var(--surface) !important;
  border: 1px solid var(--border) !important;
  border-radius: var(--radius);
  color: var(--text) !important;
  padding: .8rem 1rem;
}
details.panel summary {
  color: var(--text) !important;
  cursor: pointer;
  list-style: none;
}
details.panel summary::-webkit-details-marker { display: none; }
details.panel summary::after {
  content: "▾";
  float: right;
  color: var(--muted);
  transition: transform .2s ease;
}
details[open].panel summary::after { transform: rotate(180deg); }
details.panel p, details.panel ul, details.panel li { color: var(--text-dim) !important; }

/* Print */
@media print {
  #progress, .topbar, .share-fab, .share-menu { display: none !important; }
  body { background: #fff; color: #000; }
  .hero, .hero-banner { background: none !important; }
  a { color: #000; text-decoration: none; }
}
</style>
<script> (function(){ const btn = document.getElementById('themeToggle'); function apply(theme) { document.documentElement.classList.toggle('dark', theme === 'dark'); localStorage.setItem('theme', theme); btn.setAttribute('aria-pressed', String(theme === 'dark')); btn.textContent = theme === 'dark' ? 'Light theme' : 'Dark theme'; } // Force light as default unless a saved preference exists const saved = localStorage.getItem('theme'); apply(saved ? saved : 'light'); btn.addEventListener('click', () => { const nowDark = !document.documentElement.classList.contains('dark'); apply(nowDark ? 'dark' : 'light'); }); })(); </script>
<script type="application/ld+json">
{
  "@context":"https://schema.org",
  "@type":"Article",
  "headline":"Continuous Pricing: Beyond Filed Ladders",
  "datePublished":"2024-05-03",
  "dateModified":"2024-05-03",
  "author":{"@type":"Person","name":"Modern Airline Retailing"},
  "image":"https://www.modernairlineretailing.com/blog/images/blog-6-hero-wide.jpg",
  "keywords":"continuous pricing,dynamic pricing,fare ladders,ATPCO,airline retailing,RBD-less,Offer and Order,ONE Order,roadmap",
  "publisher":{"@type":"Organization","name":"Modern Airline Retailing"}
}
</script>
  <link rel="stylesheet" href="/assets/site.css"/>
  <link rel="stylesheet" href="/assets/post.css"/>
</head>
<body>
  <header class="site-header"></header>
  <main class="page-content">

<div id="progress" aria-hidden="true"></div>

<!-- Sticky top bar with Home + theme toggle + share -->
<div class="topbar">
  <nav class="container" style="max-width: var(--maxw); display:flex; align-items:center; justify-content:space-between; padding:.35rem 0;">
    <div>
      <a class="button is-light" href="/index.html" aria-label="Go to Home">Home</a>
    </div>
    <div style="display:flex; gap:.5rem; align-items:center;">
      <button class="theme-toggle" id="themeToggle" aria-pressed="false" aria-label="Toggle dark mode">Dark theme</button>
      <button class="button is-link" id="shareTop" aria-label="Share this page">Share</button>
    </div>
  </nav>
</div>

<section class="hero is-medium hero-banner" role="img" aria-label="Airline pricing concept illustration">
  <div class="hero-body">
    <div class="container" style="max-width: var(--maxw);">
      <h1 class="title">Continuous Pricing: Beyond Filed Ladders</h1>
      <p class="subtitle">May 03, 2024 • ~20–25 min read</p>
      <div>
        <span class="tag-badge">Pricing</span>
        <span class="tag-badge">Retailing</span>
        <span class="tag-badge">ATPCO</span>
        <span class="tag-badge">Offer &amp; Order</span>
        <span class="tag-badge">Strategy</span>
      </div>
    </div>
  </div>
</section>

<section class="section">
  <div class="container content" style="max-width: var(--maxw);">

    <div class="toc-box panel fade-in" id="toc">
      <strong>Contents</strong>
      <ol style="margin-top:.6rem;">
        <li><a href="#summary">Simple Summary</a></li>
        <li><a href="#basics">The Basics: Legacy, Dynamic, Continuous</a></li>
        <li><a href="#benefits">Why It’s Worth It</a></li>
        <li><a href="#atpco">How It Fits with ATPCO</a></li>
        <li><a href="#how-it-works">How It Works: A Friendly Overview</a></li>
        <li><a href="#phases">Your Step-by-Step Transition</a></li>
        <li><a href="#hybrid">Running the Hybrid Phase</a></li>
        <li><a href="#rbdless">Moving Toward RBD‑less</a></li>
        <li><a href="#accounting">Accounting & Settlement (Made Simple)</a></li>
        <li><a href="#interline">Interline: Play Nice with Partners</a></li>
        <li><a href="#governance">Data, Guardrails, and Fairness</a></li>
        <li><a href="#kpis">KPIs to Watch</a></li>
        <li><a href="#risks">Risks and Easy Mitigations</a></li>
        <li><a href="#faq">Quick FAQ</a></li>
        <li><a href="#checklist">Quick Checklist</a></li>
      </ol>
    </div>

    <h2 id="summary" class="fade-in">1) Simple Summary</h2>
    <p>Airlines used fixed price “rungs” tied to booking classes. Dynamic pricing adds more rungs. Continuous pricing lets you choose the best price between the rungs, safely and fairly, using rules and data. Roll it out step‑by‑step, keep accounting clean, and stay partner‑friendly.</p>

    <blockquote class="fade-in">Think of it like a dimmer switch instead of an on/off light. Smoother control fits demand better—and gets better results.</blockquote>

    <h2 id="basics" class="fade-in">2) The Basics: Legacy, Dynamic, Continuous</h2>
    <table class="inline-table panel">
      <thead><tr><th>Topic</th><th>Legacy Ladders</th><th>Dynamic (more steps)</th><th>Continuous (smooth)</th></tr></thead>
      <tbody>
        <tr><td>Price choices</td><td>Few</td><td>More</td><td>Many</td></tr>
        <tr><td>Anchor</td><td>Filed fare</td><td>Filed fare + adjustment</td><td>Model + guardrails</td></tr>
        <tr><td>Control</td><td>RBD levels</td><td>RBD + rules</td><td>Bid price + policy</td></tr>
        <tr><td>Interline</td><td>Easy</td><td>OK</td><td>Needs mapping/fallback</td></tr>
        <tr><td>Potential uplift</td><td>Baseline</td><td>Better</td><td>Best</td></tr>
      </tbody>
    </table>

    <div class="diagram fade-in" aria-label="Price granularity diagram">
Price Granularity
---------------------------------------------
Legacy:     |Y|   |B|    |M|     |H|     |Q|
Gaps leave money on the table

Dynamic:   |Y| |Y1| |B| |B1| |M| |M1|
Smaller gaps

Continuous: —— smooth curve ——
Pick the best spot for today’s demand
    </div>

    <h2 id="benefits" class="fade-in">3) Why It’s Worth It</h2>
    <ul>
      <li>Closer match between demand and price (less “gap” loss).</li>
      <li>Smoother upsell to brands and extras people want.</li>
      <li>Cleaner experiments and faster learning.</li>
      <li>Future‑proof for Offer/Order and attribute‑based retailing.</li>
    </ul>

    <h2 id="atpco" class="fade-in">4) How It Fits with ATPCO</h2>
    <p>ATPCO data still matters. It sets the rules: combinability, advance purchase, refund/change, brands, optional services, taxes, and surcharges. Continuous pricing builds on this or maps back to it for interline and settlement.</p>
    <ul>
      <li>Keep filed rules for legality and clarity.</li>
      <li>Use brands and optional services to describe the product.</li>
      <li>Track versions of data and prices for audit trails.</li>
    </ul>

    <h2 id="how-it-works" class="fade-in">5) How It Works: A Friendly Overview</h2>
    <ol>
      <li><strong>Signals:</strong> Demand, season, advance purchase, competition.</li>
      <li><strong>Guardrails:</strong> Safe min/max, margin targets, channel rules.</li>
      <li><strong>Offer build:</strong> Seat + brand + ancillaries → a clear offer.</li>
      <li><strong>Price select:</strong> Choose the best allowed price now (not just the next rung).</li>
      <li><strong>Tokenize:</strong> Return a price with a short “token” to validate at checkout.</li>
    </ol>

    <div class="diagram fade-in" aria-label="Hybrid architecture">
Hybrid Flow
---------------------------------------------
Search → Offer Engine
  → Demand signal + guardrails
  → ATPCO rules + brand data
  → Price pick (inside safe range)
← Offer (price + details + token)

Checkout → Validate token → Create order
    </div>

    <h2 id="phases" class="fade-in">6) Your Step-by-Step Transition</h2>
    <ol>
      <li><strong>More rungs:</strong> Add smaller steps (virtual buckets) on key routes.</li>
      <li><strong>Simple rules:</strong> Adjust up/down with clear conditions.</li>
      <li><strong>Use signals:</strong> Bring in a bid price or demand score.</li>
      <li><strong>Smooth the curve:</strong> Allow intermediate prices inside a safe band.</li>
      <li><strong>Go attribute‑first:</strong> Decouple price from a single letter where you can.</li>
    </ol>
    <div class="callout success fade-in">Tip: Use feature flags. You can always switch back to your old ladder if needed.</div>

    <h2 id="hybrid" class="fade-in">7) Running the Hybrid Phase</h2>
    <ul>
      <li><strong>Two expressions:</strong> Keep a link to the nearest filed anchor.</li>
      <li><strong>Fallback:</strong> If validation fails, offer the nearest allowed price with a clear note.</li>
      <li><strong>Channels:</strong> Start on your website/app; add partners who can handle it.</li>
    </ul>

    <h2 id="rbdless" class="fade-in">8) Moving Toward RBD‑less</h2>
    <ol>
      <li>List attributes customers care about (flexibility, seat, bags, priority).</li>
      <li>Map current RBDs to those attributes internally.</li>
      <li>Track capacity by attribute (e.g., “Flex seats left”).</li>
      <li>Hide RBD codes in the UI; use them internally until partners are ready.</li>
    </ol>

    <h2 id="accounting" class="fade-in">9) Accounting & Settlement (Made Simple)</h2>
    <ul>
      <li>Keep a small record: anchor fare, adjustment, taxes used, data version.</li>
      <li>Use normal tickets/EMDs today; include an Offer ID for tracing.</li>
      <li>As you move to Orders, split each item clearly (fare, bundle, extras).</li>
    </ul>

    <h2 id="interline" class="fade-in">10) Interline: Play Nice with Partners</h2>
    <ul>
      <li>When needed, send the anchor and a fair split across sectors.</li>
      <li>If partners can’t read your token yet, step back to a discrete point.</li>
      <li>Watch for rounding losses and track them as a KPI.</li>
    </ul>

    <h2 id="governance" class="fade-in">11) Data, Guardrails, and Fairness</h2>
    <ul>
      <li>Each offer: method (FILED/DYNAMIC/CONTINUOUS), model version, guardrail set, tax version.</li>
      <li>Stop odd prices with min/max and channel parity rules.</li>
      <li>Avoid sensitive attributes. Review features often.</li>
    </ul>

    <h2 id="kpis" class="fade-in">12) KPIs to Watch</h2>
    <ul>
      <li>Price gap closed (how much closer to the ideal price).</li>
      <li>Revenue uplift vs a control group.</li>
      <li>Offer-to-order reprice rate.</li>
      <li>Guardrail breach rate (keep very low).</li>
      <li>Interline rounding loss.</li>
    </ul>

    <h2 id="risks" class="fade-in">13) Risks and Easy Mitigations</h2>
    <table class="inline-table panel">
      <thead><tr><th>Risk</th><th>What can go wrong</th><th>Simple fix</th></tr></thead>
      <tbody>
        <tr><td>Channel mismatch</td><td>Customers see odd differences</td><td>Parity guardrails + clear reasons</td></tr>
        <tr><td>Overactive models</td><td>Prices bounce too much</td><td>Dampening and caps</td></tr>
        <tr><td>Slow checkout</td><td>Validation adds time</td><td>Small tokens + fast cache</td></tr>
        <tr><td>Tax mistakes</td><td>Discounts break rules</td><td>Always call the tax engine</td></tr>
      </tbody>
    </table>

    <h2 id="faq" class="fade-in">14) Quick FAQ</h2>
    <details class="panel">
      <summary><strong>Is continuous pricing legal?</strong></summary>
      <p>Yes—when you respect taxes, consumer rules, and your filed policy. Keep good records and be consistent.</p>
    </details>
    <details class="panel" style="margin-top:.6rem;">
      <summary><strong>Will this break interline?</strong></summary>
      <p>No. Use your anchor and a sensible split when needed. Fall back to a discrete step if a partner can’t accept your token.</p>
    </details>
    <details class="panel" style="margin-top:.6rem;">
      <summary><strong>How do we start small?</strong></summary>
      <p>Pick a few routes, add more rungs, then turn on simple adjustments. Measure. Grow from there.</p>
    </details>

    <h2 id="checklist" class="fade-in">15) Quick Checklist</h2>
    <ul>
      <li>Define a safe min/max range around anchors.</li>
      <li>Add smaller steps on top routes.</li>
      <li>Return a token with each price and validate it at checkout.</li>
      <li>Track versions for data, price, and taxes.</li>
      <li>Set up a dashboard for uplift, reprice rate, and breaches.</li>
      <li>Have a one‑click rollback switch.</li>
    </ul>

    <hr/>
    <nav class="level" aria-label="Article navigation">
      <div class="level-left">
        <a class="button is-link is-light" href="/blog/2024-04-11-why-caches-disagree-gds-vs-airline-host-availability.html">← Previous</a>
      </div>
      <div class="level-right">
        <a class="button is-link" href="/blog/2024-05-25-offer-construction-pricers-bundlers-and-context.html">Next →</a>
      </div>
    </nav>
    <p><a href="/blog/index.html">Back to all blogs</a></p>

  </div>
</section>

<!-- Floating Share Button and Menu -->
<button class="share-fab" id="shareFab" aria-haspopup="true" aria-controls="shareMenu">
  <span aria-hidden="true">🔗</span> Share
</button>
<div class="share-menu" id="shareMenu" role="dialog" aria-modal="false" aria-label="Share this page">
  <div style="font-weight:600; margin-bottom:.4rem;">Share this page</div>
  <div class="share-row" aria-label="Quick share">
    <a id="shareTwitter" target="_blank" rel="noopener" aria-label="Share on X/Twitter">X/Twitter</a>
    <a id="shareLinkedIn" target="_blank" rel="noopener" aria-label="Share on LinkedIn">LinkedIn</a>
    <a id="shareFacebook" target="_blank" rel="noopener" aria-label="Share on Facebook">Facebook</a>
    <button id="nativeShare" aria-label="Use device share">Device Share</button>
  </div>
  <div class="share-copy">
    <input id="shareUrl" type="text" aria-label="Page URL to copy" readonly/>
    <button id="copyBtn" class="button is-light" aria-label="Copy link">Copy</button>
  </div>
</div>

<script>
/* Reading progress */
(function(){
  const bar = document.getElementById('progress');
  const update = () => {
    const h = document.documentElement;
    const s = h.scrollTop || document.body.scrollTop;
    const d = h.scrollHeight - h.clientHeight;
    const pct = Math.max(0, Math.min(1, s / d));
    bar.style.width = (pct * 100) + '%';
  };
  document.addEventListener('scroll', update, { passive: true });
  window.addEventListener('load', update);
})();

/* Fade-in on view */
(function() {
  const els = document.querySelectorAll('.fade-in');
  const io = new IntersectionObserver(entries => {
    entries.forEach(e => { if (e.isIntersecting) e.target.classList.add('visible'); });
  }, { threshold: 0.12 });
  els.forEach(el => io.observe(el));
})();

/* Theme toggle */
(function(){
  const btn = document.getElementById('themeToggle');
  const apply = t => {
    document.documentElement.classList.toggle('dark', t === 'dark');
    localStorage.setItem('theme', t);
    btn.setAttribute('aria-pressed', String(t==='dark'));
    btn.textContent = t==='dark' ? 'Light theme' : 'Dark theme';
  };
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
  const saved = localStorage.getItem('theme');
  apply(saved || (prefersDark ? 'dark' : 'light'));
  btn.addEventListener('click', () => {
    const nowDark = !document.documentElement.classList.contains('dark');
    apply(nowDark ? 'dark' : 'light');
  });
})();

/* Share helpers */
(function(){
  const currentUrl = window.location.href.split('#')[0];
  const title = document.title;
  const shareUrlInput = document.getElementById('shareUrl');
  shareUrlInput.value = currentUrl;

  const fab = document.getElementById('shareFab');
  const topBtn = document.getElementById('shareTop');
  const menu = document.getElementById('shareMenu');
  const copyBtn = document.getElementById('copyBtn');
  const nativeBtn = document.getElementById('nativeShare');

  const tw = document.getElementById('shareTwitter');
  const li = document.getElementById('shareLinkedIn');
  const fb = document.getElementById('shareFacebook');

  tw.href = 'https://twitter.com/intent/tweet?text=' + encodeURIComponent(title) + '&url=' + encodeURIComponent(currentUrl);
  li.href = 'https://www.linkedin.com/sharing/share-offsite/?url=' + encodeURIComponent(currentUrl);
  fb.href = 'https://www.facebook.com/sharer/sharer.php?u=' + encodeURIComponent(currentUrl);

  const toggleMenu = () => menu.classList.toggle('show');
  if (fab) fab.addEventListener('click', toggleMenu);
  if (topBtn) topBtn.addEventListener('click', toggleMenu);

  copyBtn.addEventListener('click', async () => {
    try {
      await navigator.clipboard.writeText(currentUrl);
      copyBtn.textContent = 'Copied!';
      setTimeout(() => copyBtn.textContent = 'Copy', 1300);
    } catch(e) {
      shareUrlInput.select();
      document.execCommand('copy');
      copyBtn.textContent = 'Copied!';
      setTimeout(() => copyBtn.textContent = 'Copy', 1300);
    }
  });

  nativeBtn.addEventListener('click', async () => {
    if (navigator.share) {
      try { await navigator.share({ title, url: currentUrl }); } catch(_) {}
    } else {
      toggleMenu();
    }
  });

  // Close on outside click
  document.addEventListener('click', (e) => {
    if (!menu.contains(e.target) && e.target !== fab && e.target !== topBtn) {
      menu.classList.remove('show');
    }
  }, true);
})();
</script>

  </main>
  <footer class="site-footer"></footer>
  <script src="/assets/site.js" defer></script>
</body>
</html>
